{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getuserID = exports.isServer = exports.setDirection = exports.changeLanguage = exports.isRtl = exports.redirect = exports.checkTokenIsExpired = exports.filterHtmlProps = exports.debounce = exports.normalizeString = exports.sum = void 0;\n\nconst jsonwebtoken_1 = __importDefault(require(\"jsonwebtoken\"));\n\nconst routes_1 = require(\"../services/routes/routes\");\n\nconst cookie = __importStar(require(\"cookie\"));\n\nconst i18n_1 = require(\"../../i18n\");\n\nconst parseCookies_1 = __importDefault(require(\"./parseCookies\"));\n\nconst sum = (a, b) => a + b;\n\nexports.sum = sum;\n/**\n * Based on:\n * - https://stackoverflow.com/questions/20856197/remove-non-ascii-character-in-string\n * - https://gist.github.com/alisterlf/3490957\n *\n * TODO: if necessary, use a package that supports arabic, cyrillic, etc ...\n */\n\nfunction normalizeString(str) {\n  const accents = 'ÀÁÂÃÄÅĄĀāàáâãäåąßÒÓÔÕÕÖØŐòóôőõöøĎďDŽdžÈÉÊËĘèéêëęðÇçČčĆćÐÌÍÎÏĪìíîïīÙÚÛÜŰùűúûüĽĹŁľĺłÑŇŃňñńŔŕŠŚŞšśşŤťŸÝÿýŽŻŹžżźđĢĞģğ';\n  const out = 'AAAAAAAAaaaaaaaasOOOOOOOOoooooooDdDZdzEEEEEeeeeeeCcCcCcDIIIIIiiiiiUUUUUuuuuuLLLlllNNNnnnRrSSSsssTtYYyyZZZzzzdGGgg';\n  return (str || '').toLowerCase().split('').map(letter => {\n    const index = accents.indexOf(letter);\n    return index !== -1 ? out[index] : letter;\n  }) // remove accents\n  .join('').replace(/[^\\x00-\\x7F]/g, '') // remove non ascii chars\n  .replace(/[^\\w\\s]/gi, '').replace(/ /g, '-');\n}\n\nexports.normalizeString = normalizeString; // Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n// based on https://github.com/topheman/npm-registry-browser/blob/master/src/utils/helpers.js\n\nfunction debounce(func, wait, immediate) {\n  let timeout;\n  return function debounced(...args) {\n    // @ts-ignore\n    const context = this;\n\n    const later = function laterFn() {\n      timeout = null;\n\n      if (!immediate) {\n        func.apply(context, args);\n      }\n    };\n\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n\n    if (callNow) {\n      func.apply(context, args);\n    }\n  };\n}\n\nexports.debounce = debounce;\n\nfunction filterHtmlProps(props) {\n  const disallow = ['i18n', 'i18nOptions', 'defaultNS', 'reportNS', 'tReady', 'innerRef', 'translationLanguageFullCode', 'defaultLanguageShortCode', 'defaultLanguageFullCode', 'switchDefaultLanguage', 'switchTranslationLanguage', 'resetTranslationLanguage'];\n  const filteredProps = {};\n  Object.entries(props).forEach(([key, value]) => {\n    if (!disallow.includes(key)) {\n      filteredProps[key] = value;\n    }\n  });\n  return filteredProps;\n}\n\nexports.filterHtmlProps = filterHtmlProps;\n\nfunction checkTokenIsExpired(token) {\n  const decodedToken = jsonwebtoken_1.default.decode(token);\n  return decodedToken === null || typeof decodedToken === 'string' || new Date(decodedToken.exp * 1000) < new Date();\n}\n\nexports.checkTokenIsExpired = checkTokenIsExpired;\n\nconst redirect = (context, target) => {\n  if (context.res) {\n    // server\n    // 303: \"See other\"\n    context.res.writeHead(303, {\n      Location: target\n    });\n    context.res.end();\n  } else {\n    // In the browser, we just pretend like this never even happened ;)\n    routes_1.Router.replace(target);\n  }\n};\n\nexports.redirect = redirect;\nexports.isRtl = i18n_1.i18n.dir() === 'rtl' ? true : false;\n\nconst changeLanguage = ({\n  lang,\n  currentLanguage\n}) => {\n  i18n_1.i18n.changeLanguage(lang);\n\n  if (lang !== currentLanguage && lang.includes('Ar')) {\n    exports.setDirection(lang);\n    document.cookie = cookie.serialize('language', lang, {\n      maxAge: 30 * 24 * 60 * 60\n    });\n    localStorage.setItem('language', JSON.stringify(lang));\n  } else {\n    exports.setDirection(lang);\n    document.cookie = cookie.serialize('language', lang, {\n      maxAge: 30 * 24 * 60 * 60\n    });\n    localStorage.setItem('language', JSON.stringify(lang));\n  }\n};\n\nexports.changeLanguage = changeLanguage;\n\nconst setDirection = language => document.getElementsByTagName('html')[0].setAttribute('dir', language === 'Arabic' ? 'rtl' : 'ltr');\n\nexports.setDirection = setDirection;\nexports.isServer = true;\n\nconst getuserID = async () => {\n  let authToken = null;\n  let userID = null;\n  let RToken = null;\n\n  try {\n    authToken = exports.isServer ? parseCookies_1.default().authToken : await localStorage.getItem('authToken');\n    RToken = await localStorage.getItem('refreshToken');\n    console.log(authToken, userID, RToken);\n    userID = exports.isServer ? parseCookies_1.default().userID : await localStorage.getItem('userID');\n  } catch (e) {\n    console.log(e);\n  }\n};\n\nexports.getuserID = getuserID;","map":null,"metadata":{},"sourceType":"script"}