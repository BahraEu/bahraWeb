{"ast":null,"code":"\"use strict\";\n\nvar _reactJsxRuntime = require(\"react/jsx-runtime\");\n\nvar _slicedToArray = require(\"/Users/bahra/bahra/BahraPro/node_modules/@babel/runtime/helpers/slicedToArray\");\n\nvar _regeneratorRuntime = require(\"/Users/bahra/bahra/BahraPro/node_modules/@babel/runtime/regenerator\");\n\nvar _asyncToGenerator = require(\"/Users/bahra/bahra/BahraPro/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function get() {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) {\n    if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  }\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/* eslint-disable jsx-a11y/label-has-for */\n\nvar react_1 = __importDefault(require(\"react\"));\n\nvar react_hooks_1 = require(\"@apollo/react-hooks\");\n\nvar formik_1 = require(\"formik\");\n\nvar Yup = __importStar(require(\"yup\"));\n\nvar lodash_get_1 = __importDefault(require(\"lodash.get\"));\n\nvar SUBSCRIBE_graphql_1 = __importDefault(require(\"./SUBSCRIBE.graphql\"));\n\nvar SUBSCRIPTIONS_graphql_1 = __importDefault(require(\"../SubscriptionsTable/SUBSCRIPTIONS.graphql\"));\n\nvar style_1 = require(\"./style\");\n\nvar Typography_1 = require(\"../../../../styles/Typography\");\n\nvar i18n_1 = require(\"../../../../../i18n\");\n\nvar handleSubsribe = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n    var values, subscribeMutation, resetForm, subscribeResult;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            values = _ref.values, subscribeMutation = _ref.subscribeMutation, resetForm = _ref.resetForm;\n            _context.next = 3;\n            return subscribeMutation({\n              variables: {\n                input: Object.assign({\n                  source: 'HOME_PAGE'\n                }, values)\n              }\n            });\n\n          case 3:\n            subscribeResult = _context.sent;\n\n            if (lodash_get_1[\"default\"](subscribeResult, 'data.subscribe')) {\n              resetForm();\n            }\n\n            return _context.abrupt(\"return\", subscribeResult);\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function handleSubsribe(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar Subscription = function Subscription(props) {\n  var t = props.t;\n\n  var _react_hooks_1$useMut = react_hooks_1.useMutation(SUBSCRIBE_graphql_1[\"default\"], {\n    update: function update(cache, _ref3) {\n      var data = _ref3.data;\n      var dataResult = cache.readQuery({\n        query: SUBSCRIPTIONS_graphql_1[\"default\"]\n      });\n      cache.writeQuery({\n        query: SUBSCRIPTIONS_graphql_1[\"default\"],\n        data: {\n          subscriptions: dataResult && dataResult.subscriptions && dataResult.subscriptions.concat([data && data.subscribe])\n        }\n      });\n    }\n  }),\n      _react_hooks_1$useMut2 = _slicedToArray(_react_hooks_1$useMut, 1),\n      subscribeMutation = _react_hooks_1$useMut2[0];\n\n  var initialValues = {\n    email: ''\n  };\n  return /*#__PURE__*/_reactJsxRuntime.jsx(_reactJsxRuntime.Fragment, {\n    children: /*#__PURE__*/_reactJsxRuntime.jsx(style_1.SubscriptionStyle, {\n      children: /*#__PURE__*/_reactJsxRuntime.jsxs(style_1.SubscriptionWrapper, {\n        children: [/*#__PURE__*/_reactJsxRuntime.jsx(Typography_1.H3, {\n          children: t('Bahra-news-litter')\n        }), /*#__PURE__*/_reactJsxRuntime.jsx(formik_1.Formik, {\n          initialValues: initialValues,\n          onSubmit: /*#__PURE__*/function () {\n            var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(values, _ref4) {\n              var resetForm;\n              return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                while (1) {\n                  switch (_context2.prev = _context2.next) {\n                    case 0:\n                      resetForm = _ref4.resetForm;\n                      return _context2.abrupt(\"return\", handleSubsribe({\n                        values: values,\n                        subscribeMutation: subscribeMutation,\n                        resetForm: resetForm\n                      }));\n\n                    case 2:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }\n              }, _callee2);\n            }));\n\n            return function (_x2, _x3) {\n              return _ref5.apply(this, arguments);\n            };\n          }(),\n          validationSchema: Yup.object().shape({\n            email: Yup.string().email().required('Before submitting you need to provide your email')\n          }),\n          children: /*#__PURE__*/_reactJsxRuntime.jsxs(formik_1.Form, {\n            children: [/*#__PURE__*/_reactJsxRuntime.jsxs(style_1.Row, {\n              children: [/*#__PURE__*/_reactJsxRuntime.jsxs(style_1.Label, {\n                htmlFor: \"email\",\n                children: [\"Email\", /*#__PURE__*/_reactJsxRuntime.jsx(style_1.Input, {\n                  id: \"email\",\n                  name: \"email\",\n                  placeholder: \"your@email.com\",\n                  type: \"email\"\n                })]\n              }), /*#__PURE__*/_reactJsxRuntime.jsx(style_1.SubscribeButton, {\n                type: \"submit\",\n                children: \"Submit\"\n              })]\n            }), /*#__PURE__*/_reactJsxRuntime.jsx(style_1.FieldErrorRow, {\n              children: /*#__PURE__*/_reactJsxRuntime.jsx(formik_1.ErrorMessage, {\n                name: \"email\",\n                component: \"div\"\n              })\n            })]\n          })\n        })]\n      })\n    })\n  });\n};\n\nexports[\"default\"] = i18n_1.withTranslation('common')(Subscription);","map":null,"metadata":{},"sourceType":"script"}